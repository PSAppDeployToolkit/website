---
title: PSADT v4.1.8 Released
authors: [sintaxasn]
tags: [psappdeploytoolkit, powershell, release]
description: PSADT v4.1.8 strengthens MSI/MSP deployment reliability, improves process and handle safety, enhances dialog behavior, and hardens serialization and exception reporting.
---

## PSAppDeployToolkit v4.1.8

PSAppDeployToolkit v4.1.8 is now available. This is a comprehensive release that touches MSI/MSP deployment, process management, dialog behavior, and internal reliability.

<!-- truncate -->

### MSI and MSP improvements

This release brings significant improvements to Windows Installer handling:

- **Automatic MSP logging** within `Start-ADTMsiProcess` - patch installations now generate proper log files
- **Multi-product-code MSP support** - patches that target multiple product codes are now handled correctly
- **Harmonized parameters** - `Start-ADTMsiProcess` and `Start-ADTMspProcess` parameters are now fully aligned, with logging parameters shared between them
- **PassThru improvements** - `Start-ADTMsiProcess` now returns a `-PassThru` result even when an MSI isn't installed on the system
- **Version handling** - Fixed handling of MSI files that lack a `ProductVersion` property
- **Zero-Config reliability** - Fixed Zero-Config MSI code to properly use the `FileName` column

### Process and handle safety

Significant work has gone into making process and handle management more robust:

- Permissions checks now occur earlier in `ProcessManager.CreateProcessUsingToken()`
- Child processes no longer inherit duplicated handles
- Fixed `SafeThreadHandle` implementation where the handle was not releasing
- Fixed `SafeHandle` disposal for processes we don't own
- Fixed `hStdInput` handle to use `INVALID_HANDLE_VALUE` when not in use
- `FileHandleManager.GetOpenHandles()` now uses ordinal string comparison and only tests disk file handles
- Improved exception reporting in `ProcessUtilities.GetProcessImageName()` and `GetProcessArgv()`

### Dialog and UI enhancements

- **Automatic repositioning** - Dialogs now automatically reposition when screen resolution changes
- Fixed `Show-ADTInstallationWelcome` infinite dialog loop when processes can't be closed by the user
- Fixed `DialogManager.ShowBalloonTip()` disposal
- Template updated to remove `-Icon` parameter from `Show-ADTInstallationPrompt` (not supported in Fluent UI)

### Other notable fixes

- **Turkish locale** - Fixed case conversion issues with invariant `ToUpper`/`ToLower`
- **Hidden files** - Fixed hidden files/folders not being copied when referenced directly
- **Block-ADTAppExecution** - Fixed to work on `ProcessDefinition` objects
- **ESP detection** - Changed to not require `CloudAssignedTenantId` (supports Windows 365 devices)
- **Network connections** - `Test-ADTNetworkConnection` now includes Wi-Fi connections by default
- **UTF-8 BOM** - Module file encoding standardized to UTF-8 with BOM
- **Copy-ADTContentToCache** - Fixed error on re-run when source and destination are the same
- **Desktop icon cache** - Fixed refresh behavior
- **`/Debug` mode** - Now only works in user-interactive processes

### CI improvements

Build performance has been significantly improved with parallelized code signing and dependency caching. Build time reduced from 23+ minutes to approximately 7 minutes.

### New property

- Added `IsAdmin` property to `RunAsActiveUser` object

For the full list of changes, see the [release notes](/docs/getting-started/release-notes).

### Download

**[PSAppDeployToolkit v4.1.8](https://github.com/psappdeploytoolkit/psappdeploytoolkit/releases/tag/4.1.8)**
