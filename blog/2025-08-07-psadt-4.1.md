---
title: PSADT v4.1.0 Released
authors: [sintaxasn]
tags: [psappdeploytoolkit, powershell, release]
description: PSADT v4.1.0 brings a major security rearchitecture enabling native SYSTEM-to-user UI without ServiceUI, full Fluent/Classic UI parity, powerful new process execution capabilities, and Group Policy support.
---

## PSAppDeployToolkit v4.1.0 is here

We are very excited to announce the release of PSAppDeployToolkit v4.1.0! This is a landmark release that fundamentally changes how PSADT handles user interaction during SYSTEM deployments and introduces a wealth of new capabilities.

<!-- truncate -->

### Native UI from SYSTEM deployments - no more ServiceUI

The headline feature of v4.1.0 is the completely rearchitected client/server model for user interaction. Up until now, displaying any UI when deploying as SYSTEM with Intune (or any endpoint management tool) required ServiceUI.

**That is no longer the case.**

We strongly advise you stop using ServiceUI as soon as possible. It works by manipulating system security tokens in a way that could allow malicious actors to escalate privileges or bypass security controls. Our new approach leverages the Windows security model and separates user interactions onto a process running in the user's session - we never perform any user interaction within the SYSTEM context. This also removes the requirement for the 'Allow users to view and interact with the program installation' checkbox in Configuration Manager deployments.

### Full Fluent and Classic UI parity

There is now **full feature parity** between the Fluent and Classic User Interfaces, including:

- Deferral Deadline and Countdown Timer on Close Apps Dialog
- Ability to prevent the Restart Dialog from being dismissed once a certain countdown point is reached
- Ability to allow users to move dialogs and set initial dialog placement
- PowerShell ISE compatibility

The Fluent UI has also gained exclusive new features: input box prompts, formattable text (bold, italic, accent) with URL hyperlinks in dialog messages, progress bar percentage control, and separate Light/Dark mode icons.

### Powerful new process execution capabilities

The security rearchitecture required a full rewrite of our process execution code, which enabled new capabilities for both `Start-ADTProcess` and `Start-ADTProcessAsUser`:

- **`-UseUnelevatedToken`** - Force a process to run without elevation, for Windows 11 Administrator Protection
- **`-WaitForChildProcesses`** - Wait for all child processes to end
- **`-KillChildProcessesWithParent`** - Close all child processes once the main process ends
- **`-Timeout`** with `-TimeoutAction` and `-NoTerminateOnTimeout` for timeout control
- **`-ExpandEnvironmentVariables`** - Allow `%AppData%` expansion when running as a user
- **`-StreamEncoding`** - Useful for apps like Winget that use UTF-8

### Group Policy support

It's now possible to set PSADT configuration settings via Group Policy using the included ADMX templates, overriding any settings in `config.psd1`. This allows you to change, update, or enforce settings across an entire organization.

### New functions

- Environment variable management: `Get/Set/Remove-ADTEnvironmentVariable`
- INI file management: `Get/Set/Remove-ADTIniSection` and `Get/Set/Remove-ADTIniValue`
- `Start-ADTMsiProcessAsUser` for user-context MSI installs via SYSTEM
- `Test-ADTEspActive` for Enrollment Status Page detection

### Important changes

- `DeployMode` now defaults to `Auto`, which intelligently switches to silent when appropriate
- Default `DeferExitCode` changed from `60012` to `1602` (natively recognized by ConfigMgr and Intune)
- UI functions no longer minimize windows by default

For full details, see the [release notes](/docs/getting-started/release-notes) and the [upgrade guidance](/docs/getting-started/upgrade-guidance-4x-to-v41).

### Download

**[PSAppDeployToolkit v4.1.0](https://github.com/psappdeploytoolkit/psappdeploytoolkit/releases/tag/4.1.0)**

### Rapid follow-up patches

Following the v4.1.0 release, we shipped several rapid patch releases (v4.1.1 through v4.1.5) addressing early feedback and edge cases. We recommend updating to the [latest release](https://github.com/psappdeploytoolkit/psappdeploytoolkit/releases/latest) for the best experience.
