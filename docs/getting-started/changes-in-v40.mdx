---
sidebar_position: 6
title: 'Changes in v4.0'
description: 'Guidance on what has changed in v4.0'
slug: /getting-started/changes-in-v40
hide_title: true
tags:
  - Changes
  - Getting Started
---

# Changes in PSAppDeployToolkit 4.0

### Overview

- **Added** modern Fluent user interface
- **Added** digitally signed PowerShell module
- **Changed** all C# code to be compiled
- **Changed** codebase with complete refactoring and optimization
- **Removed** all VBScript code
- **Added** strongly typed and defined object types (no more PSCustomObjects, etc.)
- **Added** defensive coding to ensure security and reliability
- **Added** PowerShell 7 and ARM support
- **Added** extensions support as supplemental modules
- **Added** custom action support for extensions on deployment start and finish
- **Added** support for overriding config via the registry
- **Added** backwards-compatibility with v3 deployment scripts

### Key Filename Changes

:::info
Further changes to the deployment layout are detailed in the [Deployment Structure](../deployment-concepts/deployment-structure.mdx) page.
:::

| **Old Name**                 | **New Name**                  | **More Information**                                                            |
|:-----------------------------|:------------------------------|:--------------------------------------------------------------------------------|
| `Deploy-Application.ps1`     | `Invoke-AppDeployToolkit.ps1` | [Invoke-AppDeployToolkit](../usage/invoke-appdeploytoolkit.mdx)|
| `Deploy-Application.exe`     | `Invoke-AppDeployToolkit.exe` | [Invoke-AppDeployToolkit](../usage/invoke-appdeploytoolkit.mdx)|
| `AppDeployToolkitConfig.xml` | `Config\Config.psd1`          | [Configuration Settings](../reference/config-settings.mdx)                   |
| *Was part of Config file*    | `Strings\Strings.psd1`        | [Language Strings](../reference/language-strings.mdx)                        |

## New Configuration Format

- **Changed** to **.psd1** as the native PowerShell config file format. See [Customizing Deployments](../usage/customizing-deployments.mdx) for more information.

## Key Function Name Changes

:::info
For a detailed mapping of all v3 to v4 functions, see the [Function Mapping](../reference/v4-function-mapping.mdx) page.
:::

- **Changed** certain function names to avoid collisions with other scripts or modules.

| **Old Name**      | **New Name / Details**                                             |
|:------------------|:-------------------------------------------------------------------|
| `Copy-File`       | [`Copy-ADTFile`](../reference/functions/Copy-ADTFile.mdx)           |
| `Execute-Process` | [`Start-ADTProcess`](../reference/functions/Start-ADTProcess.mdx)   |
| `Write-Log`       | [`Write-ADTLogEntry`](../reference/functions/Write-ADTLogEntry.mdx) |

## Variables

- **Changed** standard toolkit environment variables, such as `$envProgramFiles`, to become available once an [ADTSession](../reference/adtsession-object.mdx) is opened or after the `Export-ADTEnvironmentTableToSessionState` command is executed
- **Changed** variables specific to a particular deployment (for example, `$appName`) to be found within the [ADTSession](../reference/adtsession-object.mdx) object (for example, `$adtSession.AppName`)

## Booleans Replaced with Switches

**Changed** from many Boolean parameters in v3 (some defaulting to true and others to false) to a clearer switch-based system. It was not always clear what the default behavior was without referencing documentation.

- **Changed** from `TopMost $true` or `-TopMost $false` to a single optional switch, `-NotTopMost`, which clarifies that the default behavior is TopMost

## Standardized Filtering

**Changed** the `Remove-MsiApplications` command from v3 that used `-FilterApplication` and `-ExcludeFromUninstall` parameters with a complex syntax. In the new function, [Uninstall-ADTApplication](../reference/functions/Uninstall-ADTApplication.mdx), these have been **replaced** with a single `-FilterScript`, similar to PowerShell's `Where-Object`:

```powershell
-FilterScript { $_.Publisher -eq 'Oracle Corporation' -and $_.DisplayVersion -notmatch 'Java 8 Update 45' }
```

## ScriptBlock Variables

**Changed** from `Invoke-HKCURegistrySettingsForAllUsers` in v3 that required a `$UserProfile` variable. In v4, [Invoke-ADTAllUsersRegistryAction](../reference/functions/Invoke-ADTAllUsersRegistryAction.mdx) pipes user profile objects to the provided scriptblock, so you can use `$_`:

```powershell
Invoke-ADTAllUsersRegistryAction -ScriptBlock {
    Set-ADTRegistryKey -Key 'HKCU\Software\Microsoft\Office\14.0\Common' -Name 'qmenable' -Value 0 -Type DWord -SID $_.SID
}
```

## Standardized Array Inputs

**Changed** functions that accept multiple values to take arrays rather than comma-delimited strings. For example, **instead of**:

```powershell
Show-InstallationWelcome -CloseApps 'iexplore,winword,excel'
```

you can specify:

```powershell
Show-ADTInstallationWelcome -CloseProcesses iexplore, winword, excel
```

## Error Handling

**Changed** from many commands in v3 that used a `-ContinueOnError` parameter. In v4, you use the standard PowerShell `-ErrorAction` parameter:

- **Changed** from `-ContinueOnError $true` or `$false` to `-ErrorAction Stop` or `-ErrorAction SilentlyContinue`

## Uninstallation of EXE Apps

**Added** support for [Uninstall-ADTApplication](../reference/functions/Uninstall-ADTApplication.mdx) to uninstall **EXE** apps in addition to **MSI**. Specify the `-ApplicationType` parameter to focus on one type or the other. The `-ArgumentList` parameter replaces any detected arguments in the registry, and `-AdditionalArgumentList` appends to them.

## User Profile Paths

**Added** `-LoadProfilePaths` switch to [Get-ADTUserProfiles](../reference/functions/Get-ADTUserProfiles.mdx) to discover common folders within user profiles, such as **Documents** and **Desktop**. You can use [Copy-ADTFileToUserProfiles](../reference/functions/Copy-ADTFileToUserProfiles.mdx) to copy files directly to these locations.

## WIM Support

**Added** support for compressing file content into a WIM archive and mounting it during installation. You can manage this manually using [Mount-ADTWimFile](../reference/functions/Mount-ADTWimFile.mdx) and [Dismount-ADTWimFile](../reference/functions/Dismount-ADTWimFile.mdx), or you can use the `-ForceWimDetection` switch with [Open-ADTSession](../reference/functions/Open-ADTSession.mdx) to auto-mount and dismount any WIM files found.

**Added** [Zero Config](../deployment-concepts/zero-config-deployment.mdx) feature that starts automatically if you leave the **AppName** blank, mounts any WIM file found, and installs the MSI located inside.
