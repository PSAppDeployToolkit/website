---
sidebar_position: 2
title: 'Invoke-AppDeployToolkit'
description: 'Understanding how a PSAppDeployToolkit deployment is structured.'
slug: /usage/invoke-appdeploytoolkit
hide_title: true
tags:
  - Usage
  - Invoke-AppDeployToolkit
---

# Deployment Script

The `Invoke-AppDeployToolkit.ps1` script is where you will spend most of your time when using PSAppDeployToolkit. This script is the main entry point of the deployment, responsible for executing the deployment phases.

## Session Variables

The first thing to edit in your deployment script is the session variables. These variables are used to control the behavior of the deployment and are set at the top of your script.

| Variable | Example | Description |
| -------- | ------- | ----------- |
| AppVendor | Microsoft | The vendor name of the application |
| AppName | Office 365 | The name of the application |
| AppVersion | 16.0 | The version of the application |
| AppArch | x64 | The architecture of the application (x86 or x64) |
| AppLang | EN | The language of the application |
| AppRevision | 01 | The revision of the application package |
| AppSuccessExitCodes | @(0) | Exit codes that indicate success |
| AppRebootExitCodes | @(1641, 3010) | Exit codes that indicate a reboot is required |
| AppProcessesToClose | @('winword', 'excel') | Processes that should be closed before installation |
| AppScriptVersion | 1.0.0 | Version of your deployment script |
| AppScriptDate | 2023-07-07 | Date the script was created or last modified in YYYY-MM-DD format |
| AppScriptAuthor | IT Admin | Author of the deployment script |
| RequireAdmin | $true | Whether the script requires administrative privileges |

:::tip
Set `RequireAdmin = $false` for user-context installs that do not require admin rights.
:::

:::tip
If you set `ProcessDetection = $true` in **Config.psd1**, **DeployMode** will automatically be switched to **Silent**  if none of the defined processess are running.
:::

## Deployment Types

The script is broken down into three main deployment types:

- `Install`
- `Uninstall`
- `Repair`

## Deployment Phases

Use `Pre-InstallType`, `InstallType`, and `Post-InstallType` phases to organize tasks for installation, uninstallation, or repair.

## Script

The script is broken down into the following sections:

| **Install Type**          | **Phase**        | **Deployment Tasks**                                                                |
| :------------------------ | :----------------| :---------------------------------------------------------------------------------- |
| `Install-ADTDeployment`   | `Pre-Install`    | Prompt to close processes, allow defer, uninstall / clean-up previous versions      |
|                           | `Install`        | Install application                                                                 |
|                           | `Post-Install`   | Drop additional files, registry tweaks, cleanup, prompt for restart                 |
|                           |                  |                                                                                     |
| `Uninstall-ADTDeployment` | `Pre-Uninstall`  | Display end user messaging, close processes                                         |
|                           | `Uninstall`      | Uninstall application                                                               |
|                           | `Post-Uninstall` | Prompt for restart                                                                  |
|                           |                  |                                                                                     |
| `Repair-ADTDeployment`    | `Pre-Repair`     | Display end user messaging, close processes, uninstall / clean up previous versions |
|                           | `Repair`         | Repair application                                                                  |
|                           | `Post-Repair`    | Drop additional files, registry tweaks, reset settings, prompt for restart          |
