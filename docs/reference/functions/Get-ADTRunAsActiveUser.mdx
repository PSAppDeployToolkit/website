---
id: Get-ADTRunAsActiveUser
title: Get-ADTRunAsActiveUser
hide_title: false
hide_table_of_contents: false
---

## SYNOPSIS

Retrieves the active user session information.

## SYNTAX

```powershell
Get-ADTRunAsActiveUser
```

## DESCRIPTION

The Get-ADTRunAsActiveUser function determines the account that will be used to execute commands in the user session when the toolkit is running under the SYSTEM account.

The active console user will be chosen first.
If no active console user is found, for multi-session operating systems, the first logged-on user will be used instead.

## EXAMPLES

### EXAMPLE 1

```powershell
Get-ADTRunAsActiveUser
```

This example retrieves the active user session information.

## PARAMETERS

## INPUTS

### None

### You cannot pipe objects to this function.
## OUTPUTS

### PSADT.TerminalServices.SessionInfo

### Returns a custom object containing the user session information.
## NOTES
An active ADT session is NOT required to use this function.

Tags: psadt<br />
Website: https://psappdeploytoolkit.com<br />
Copyright: (C) 2025 PSAppDeployToolkit Team (Sean Lillis, Dan Cunningham, Muhammad Mashwani, Mitch Richters, Dan Gough).<br />
License: https://opensource.org/license/lgpl-3-0

## RELATED LINKS

[https://psappdeploytoolkit.com/docs/reference/functions/Get-ADTRunAsActiveUser](https://psappdeploytoolkit.com/docs/reference/functions/Get-ADTRunAsActiveUser)
