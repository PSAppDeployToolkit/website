---
sidebar_position: 2
title: 'Invoke-AppDeployToolkit'
description: 'Understanding how a PSAppDeployToolkit deployment is structured.'
slug: /deployment-concepts/invoke-appdeploytoolkit
hide_title: true
tags:
  - Usage
  - Invoke-AppDeployToolkit
  - Deployment Concepts
---

# Deployment Script

The `Invoke-AppDeployToolkit.ps1` script is where you will spend most of your time when using PSAppDeployToolkit. This script is the main entry point of the deployment, responsible for executing the deployment phases.

## Session Variables

The first thing to edit in your deployment script is the session variables. These variables are used to control the behavior of the deployment and are set at the top of your script.

| Variable | Example | Description |
| -------- | ------- | ----------- |
| `AppVendor` | `Microsoft` | The vendor name of the application |
| `AppName` | `Office 365` | The name of the application |
| `AppVersion` | `16.0` | The version of the application |
| `AppArch` | `x64` | The architecture of the application (x86 or x64) |
| `AppLang` | `EN` | The language of the application |
| `AppRevision` | `01` | The revision of the application package |
| `AppSuccessExitCodes` | `@(0)` | Exit codes that indicate success |
| `AppRebootExitCodes` | `@(1641, 3010)` | Exit codes that indicate a reboot is required |
| `AppProcessesToClose` | `@(@{ Name = 'winword'; Description = 'Microsoft Word' })` | **New in v4.1**. Processes that should be closed before install / uninstall / repair. |
| `RequireAdmin` | `$true` | **New in v4.1**. Whether the script requires administrative privileges |

:::warning Breaking Changes in v4.1
If you are upgrading from v4.0 or earlier, you must move any `RequireAdmin` setting from your config file to the session object in your deployment script, and use `AppProcessesToClose` instead of specifying the processes directly on the `-CloseProcesses` parameter of `Show-ADTInstallationWelcome`.
:::

:::note
PSADT v4.1 contains a new variable `RequireAdmin` that allows you to check for administrative rights on a per-application basis without needing to modify the PSADT configuration file.

- `RequireAdmin = $true`, will fail the deployment if admin rights are not available.
- `RequireAdmin = $false`, will run in the users context without requiring administrative rights.
:::

:::note New in v4.1: AppProcessesToClose
PSADT v4.1 contains a new variable `AppProcessesToClose` that allows you to specify processes to be closed before the installation, uninstallation, or repair phases. This replaces the previous method of using the -CloseApps parameter on `Show-InstallationWelcome`

- `AppProcessesToClose = <populated>`, will automatically close the specified processes before proceeding with the deployment.
:::

:::tip
Use hashtable objects on `AppProcessesToClose` with `Name` and `Description` properties for better user experience.
```PowerShell
AppProcessesToClose = @(@{ Name = 'winword'; Description = 'Microsoft Word' })
```
:::

## Deployment Types & Phases

There are three types of deployments you can perform using PSAppDeployToolkit.

- **Install**, **Uninstall** and **Repair**.

Each type has its own set of phases that define the tasks to be performed during the deployment process.

- **Pre-Install**, **Install**, and **Post-Install**.
- **Pre-Uninstall**, **Uninstall**, and **Post-Uninstall**.
- **Pre-Repair**, **Repair**, and **Post-Repair**.

## Script Structure

The script is broken down into the following sections:

| **Install Type**          | **Phase**        | **Deployment Tasks**                                                                |
| :------------------------ | :----------------| :---------------------------------------------------------------------------------- |
| `Install-ADTDeployment`   | `Pre-Install`    | Prompt to close processes, allow defer, uninstall / clean-up previous versions      |
|                           | `Install`        | Install application                                                                 |
|                           | `Post-Install`   | Drop additional files, registry tweaks, cleanup, prompt for restart                 |
|                           |                  |                                                                                     |
| `Uninstall-ADTDeployment` | `Pre-Uninstall`  | Display end user messaging, close processes                                         |
|                           | `Uninstall`      | Uninstall application                                                               |
|                           | `Post-Uninstall` | Prompt for restart                                                                  |
|                           |                  |                                                                                     |
| `Repair-ADTDeployment`    | `Pre-Repair`     | Display end user messaging, close processes, uninstall / clean up previous versions |
|                           | `Repair`         | Repair application                                                                  |
|                           | `Post-Repair`    | Drop additional files, registry tweaks, reset settings, prompt for restart          |
